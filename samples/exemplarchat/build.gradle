apply plugin: 'com.github.johnrengelman.shadow'

dependencies {
  implementation dep.kotlinStdLib
  implementation dep.kotlinTest
  implementation dep.guava
  implementation dep.guice
  implementation dep.logbackClassic
  implementation project(':misk')
  implementation project(':misk-prometheus')
  implementation project(':misk-eventrouter')

  testImplementation project(':misk-testing')
}

jar {
  manifest {
    attributes 'Main-Class': 'com.squareup.chat.ChatServiceKt'
  }
  classifier = 'unshaded'
}


shadowJar {
  exclude('module-info.class') // https://github.com/johnrengelman/shadow/issues/352
  mergeServiceFiles()
  into("web/exemplarchat") {
    from("web/build")
  }
}

artifacts {
  archives shadowJar
}
